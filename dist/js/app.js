"use strict";var mapBoxApiKey="pk.eyJ1Ijoic3VwZXJ4aW4iLCJhIjoiY2thNWlqZHd4MDBpODNnb3owMDA2Y3dnYiJ9.-zciQf0emsOdjhIjB2uoNA",wpgTransitApiKey="G0ZNynR9C1I5fFkrMET",originForm=document.querySelector(".origin-form"),destinationForm=document.querySelector(".destination-form"),originResultsList=document.querySelector(".origins"),destinationResultsList=document.querySelector(".destinations"),btn=document.querySelector(".plan-trip");function searchLocations(t,e){fetch("https://api.mapbox.com/geocoding/v5/mapbox.places/".concat(t,".json?access_token=").concat(mapBoxApiKey,"&limit=10&bbox=-97.325875,49.766204,-96.953987,49.99275")).then(function(t){if(t.ok)return t.json();throw new Error("Fail to get data from API.")}).then(function(t){return updateResults(t.features,e)})}function updateResults(t,e){var n="";t.forEach(function(t){void 0===t.properties.address&&(t.properties.address=""),n+='   \n      <li data-long="'.concat(t.center[0],'" data-lat="').concat(t.center[1],'" class="">\n        <div class="name">').concat(t.text,"</div>\n        <div>").concat(t.properties.address,"</div>\n      </li> \n    ")}),e.innerHTML=n}function clickResult(t){null!==t.target.closest("li")&&(document.querySelectorAll(".".concat(t.target.closest("ul").className," > li")).forEach(function(t){return t.classList.remove("selected")}),t.target.closest("li").classList.add("selected"))}originForm.addEventListener("submit",function(t){var e=originForm.querySelector("input");""!==e.value.trim()&&searchLocations(e.value,originResultsList),e.value="",t.preventDefault()}),destinationForm.addEventListener("submit",function(t){var e=destinationForm.querySelector("input");""!==e.value.trim()&&searchLocations(e.value,destinationResultsList),e.value="",t.preventDefault()}),originResultsList.addEventListener("click",function(t){return clickResult(t)}),destinationResultsList.addEventListener("click",function(t){return clickResult(t)}),btn.addEventListener("click",function(){var t=document.getElementsByClassName("selected");if(2===t.length){var e=[t[0].dataset.lat,t[0].dataset.long],n=[t[1].dataset.lat,t[1].dataset.long];fetch("https://api.winnipegtransit.com/v3/trip-planner.json?origin=geo/".concat(e[0],",").concat(e[1],"&destination=geo/").concat(n[0],",").concat(n[1],"&api-key=").concat(wpgTransitApiKey)).then(function(t){if(t.ok)return t.json();throw new Error("Fail to get data from API.")}).then(function(t){return console.log(t)})}});